
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>M-Gacha Carnival</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Nunito', sans-serif;
      background: linear-gradient(to bottom, #89CFF0, #4682B4);
      color: #002c5f;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      background-image: url('./assets/bg-pattern.png');
      background-size: cover;
    }
    header img {
      width: 180px;
      margin: 10px;
    }
    h1 {
      text-align: center;
      font-size: 2rem;
      color: #fff;
    }
    .gift-row {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .gift-box {
      width: 120px;
      height: 120px;
      background: url('https://cdn-icons-png.flaticon.com/512/3468/3468371.png') no-repeat center/contain;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .gift-box:hover {
      transform: scale(1.1);
    }
    #spin-count {
      margin: 20px 0;
      font-size: 1.2rem;
      color: white;
    }
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    .popup-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      color: #002c5f;
      animation: popupFade 0.5s ease;
    }
    .popup-content h2 {
      margin-bottom: 10px;
    }
    @keyframes popupFade {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    footer {
      margin-top: auto;
      color: white;
      font-size: 0.8rem;
      text-align: center;
      padding: 20px;
    }
  </style>
</head>
<body>
  <header>
    <img src="./assets/logo-mandiri.png" alt="Mandiri Logo">
    <h1>üéâ Pilih Hadiahmu Sekarang!</h1>
  </header>

  <div id="spin-count">Spin ke-0 dari 10</div>
  <div class="gift-row">
    <div class="gift-box" onclick="openBox()"></div>
    <div class="gift-box" onclick="openBox()"></div>
    <div class="gift-box" onclick="openBox()"></div>
    <div class="gift-box" onclick="openBox()"></div>
  </div>

  <div class="popup" id="popup">
    <div class="popup-content">
      <h2>üéÅ Selamat!</h2>
      <p id="popup-message"></p>
      <button onclick="closePopup()">OK</button>
    </div>
  </div>

  <footer>
    &copy; 2025 Bank Mandiri - M-Gacha Carnival UI<br>
    Pajak hadiah ditanggung Mandiri. Ilustrasi tidak mengikat.
  </footer>

  <audio id="click-sound" src="https://www.soundjay.com/button/sounds/button-3.mp3"></audio>
  <audio id="win-sound" src="https://www.soundjay.com/button/sounds/button-09.mp3"></audio>

  <script>
    const prizes = ["+3 Poin M-Gacha", "i-Voucher Indomaret Rp 50.000", "i-Voucher Indomaret Rp 100.000", "Voucher Alfamart Rp 50.000", "Voucher Alfamart Rp 100.000", "Voucher Grab Rp 50.000", "iPhone 15 128GB", "Samsung Smart TV 32 Inch", "Honda Vario 125 CBS ISS", "Logam Mulia 1gr"];
    const weights = [85, 3, 2, 2, 2, 2, 1, 1, 1, 1];
    let spins = 0;

    function openBox() {
      if (spins >= 10) {
        showPopup("Kamu sudah mencapai batas harian. Coba lagi besok!");
        return;
      }
      document.getElementById('click-sound').play();
      spins++;
      document.getElementById('spin-count').innerText = `Spin ke-${spins} dari 10`;
      const prize = pickPrize();
      showPopup(prize);
      document.getElementById('win-sound').play();
      logToSheets(prize);
    }

    function pickPrize() {
      let total = weights.reduce((a, b) => a + b, 0);
      let rand = Math.random() * total;
      for (let i = 0; i < weights.length; i++) {
        if (rand < weights[i]) return prizes[i];
        rand -= weights[i];
      }
    }

    function showPopup(message) {
      document.getElementById('popup-message').innerText = message;
      document.getElementById('popup').style.display = 'flex';
    }

    function closePopup() {
      document.getElementById('popup').style.display = 'none';
    }

    function logToSheets(prize) {
      fetch("https://script.google.com/macros/s/AKfycbx_q-_TULKUZk-zJD4Rws0eR9mTb0mPbOf_bD5kD5xJzV2CUcE_eZBRGVbUw0Im3gM/exec", {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ hadiah: prize })
      });
    }
  </script>

<!-- Gift List Button -->
<button onclick="showGiftList()" style="position: absolute; top: 20px; right: 20px; background: white; border-radius: 10px; border: none; padding: 10px 16px; font-weight: bold; cursor: pointer;">
  üéÅ Daftar Hadiah
</button>

<!-- Gift List Modal -->
<div class="popup" id="giftListPopup">
  <div class="popup-content" style="max-width: 400px;">
    <h2>üéÅ Daftar Hadiah</h2>
    <ul style="text-align: left; padding-left: 20px;">
      <li>+3 Poin M-Gacha</li>
      <li>i-Voucher Indomaret Rp 50.000</li>
      <li>i-Voucher Indomaret Rp 100.000</li>
      <li>Voucher Alfamart Rp 50.000</li>
      <li>Voucher Alfamart Rp 100.000</li>
      <li>Voucher Grab Rp 50.000</li>
      <li>iPhone 15 128GB</li>
      <li>Samsung Smart TV 32 Inch</li>
      <li>Honda Vario 125 CBS ISS</li>
      <li>Logam Mulia 1gr</li>
    </ul>
    <button onclick="closeGiftList()">Tutup</button>
  </div>
</div>

<script>
function showGiftList() { document.getElementById('giftListPopup').style.display = 'flex'; }
function closeGiftList() { document.getElementById('giftListPopup').style.display = 'none'; }
</script>
</body>
</html>
