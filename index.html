<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>M-Gacha Carnival</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      font-family: "Arial", sans-serif;
      background: url("assets/background.png") no-repeat center center fixed;
      background-size: cover;
      color: white;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }

    .logo {
      width: 120px;
      margin: 20px auto 10px;
    }

    .menu-buttons {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .menu-buttons button {
      padding: 10px 16px;
      font-size: 14px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }

    .info {
      margin-top: 5px;
      font-size: 18px;
    }

    .sub-info {
      font-size: 14px;
      margin-bottom: 20px;
    }
      .gift-container {
    display: grid;
    grid-template-columns: repeat(2, 120px);
    grid-template-rows: repeat(2, 120px);
    gap: 24px 24px;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
  }

  .gift-box {
    width: 120px;
    height: 120px;
    background: url("assets/gift-box.png") no-repeat center center;
    background-size: contain;
    cursor: pointer;
  }
    }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: black;
      padding: 20px;
      border-radius: 12px;
      display: none;
      z-index: 1000;
    }

    .popup button {
      margin-top: 10px;
      padding: 8px 14px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .reward-history, .reward-list {
      display: none;
      position: fixed;
      top: 70px;
      right: 10px;
      background: white;
      color: black;
      padding: 15px;
      border-radius: 12px;
      max-height: 300px;
      overflow-y: auto;
      z-index: 1000;
      text-align: left;
      font-size: 14px;
    }

    .reward-history ul, .reward-list ul {
      padding-left: 18px;
    }
  </style>
</head>
<body>
  <img src="assets/logo-mandiri.png" alt="Mandiri Logo" class="logo"/>

  <div class="menu-buttons">
    <button onclick="toggleRewardList()">üéÅ Daftar Hadiah</button>
    <button onclick="toggleHistory()">üì¶ HadiahMu</button>
  </div>

  <div class="info">üòä M-Gacha Poin: <span id="points">10</span></div>
  <div class="info">Kesempatan Hari ini: <span id="chances">10</span>x</div>
  <div class="sub-info">Tukarkan 2 poin untuk 1x kesempatan</div>

  <div class="gift-container" id="giftContainer"></div>

  <div class="popup" id="rewardPopup"></div>

  <div class="reward-list" id="rewardList">
    <strong>üéÅ Daftar Hadiah:</strong>
    <ul>
      <li>+3 M-Gacha Poin</li>
      <li>i-Voucher Indomaret Rp 50.000</li>
      <li>i-Voucher Indomaret Rp 100.000</li>
      <li>Voucher Alfamart Rp 50.000</li>
      <li>Voucher Alfamart Rp 100.000</li>
      <li>Voucher Grab Rp 50.000</li>
      <li>Iphone 15 128GB</li>
      <li>Samsung Smart TV 32"</li>
      <li>Honda Vario 125 CBS ISS</li>
      <li>Logam Mulia 1gr</li>
    </ul>
  </div>

  <div class="reward-history" id="rewardHistory">
    <strong>üì¶ HadiahMu:</strong>
    <ul id="historyList"></ul>
  </div>

  <audio id="sound" src="assets/arcade-sound.mp3"></audio>

  <script>
    const rewards = [
      ...Array(98).fill("+3 M-Gacha Poin"),
      "i-Voucher Indomaret Rp 50.000",
      "i-Voucher Indomaret Rp 100.000",
      "Voucher Alfamart Rp 50.000",
      "Voucher Alfamart Rp 100.000",
      "Voucher Grab Rp 50.000",
      "Iphone 15 128GB",
      "Samsung Smart TV 32\"",
      "Honda Vario 125 CBS ISS",
      "Logam Mulia 1gr"
    ];

    let points = 10;
    let chances = 10;
    let history = [];

    const giftContainer = document.getElementById("giftContainer");
    const pointsEl = document.getElementById("points");
    const chancesEl = document.getElementById("chances");
    const rewardPopup = document.getElementById("rewardPopup");
    const historyList = document.getElementById("historyList");
    const sound = document.getElementById("sound");

    function updateDisplay() {
      pointsEl.textContent = points;
      chancesEl.textContent = chances;
    }

    function toggleRewardList() {
      const list = document.getElementById("rewardList");
      list.style.display = list.style.display === "block" ? "none" : "block";
    }

    function toggleHistory() {
      const h = document.getElementById("rewardHistory");
      h.style.display = h.style.display === "block" ? "none" : "block";
    }

    function showRewardPopup(reward) {
      rewardPopup.innerHTML = `üéâ Kamu mendapat: <b>${reward}</b><br/><button onclick="closeRewardPopup()">Main Lagi</button>`;
      rewardPopup.style.display = "block";
    }

    function closeRewardPopup() {
      rewardPopup.style.display = "none";
    }

    function sendToSheets(reward) {
      const data = {
        timestamp: new Date().toISOString(),
        nama: "Demo Nasabah",
        cif: "1234567890",
        norek: "9000000001",
        hp: "08123456789",
        email: "demo@email.com",
        reward: reward
      };

      fetch("https://script.google.com/macros/s/AKfycbwYHTbpOPV0P3qwu06kgDZA3hnNJABi16ofPkBn48kV9cmo_zV-ieSYtbCzBwkooA1P/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
    }

    function createGiftBox(index) {
      const box = document.createElement("div");
      box.className = "gift-box";
      box.onclick = () => {
        if (points < 2 || chances <= 0) {
          alert("Kamu kehabisan kesempatan atau poin.");
          return;
        }

        sound.play();
        chances--;
        points -= 2;

        const reward = rewards[Math.floor(Math.random() * rewards.length)];

        if (reward === "+3 M-Gacha Poin") points += 3;

        history.push(reward);
        updateDisplay();
        showRewardPopup(reward);
        sendToSheets(reward);

        const li = document.createElement("li");
        li.textContent = reward;
        historyList.appendChild(li);
      };
      return box;
    }

    function renderGifts() {
      giftContainer.innerHTML = "";
      for (let i = 0; i < 4; i++) {
        giftContainer.appendChild(createGiftBox(i));
      }
    }

    updateDisplay();
    renderGifts();
  </script>
</body>
</html>
